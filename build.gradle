plugins {
    id 'application'
}

group = 'br.com.spedison'
version = '1.0-SNAPSHOT'

java {
    toolchain {
        languageVersion.set(JavaLanguageVersion.of(21)) // Força uso do JDK 21
    }
}

repositories {
    mavenCentral()
}

dependencies {

// https://mvnrepository.com/artifact/org.eclipse.jetty/jetty-server
    implementation 'org.eclipse.jetty:jetty-server:12.0.16'
// https://mvnrepository.com/artifact/org.eclipse.jetty.ee10/jetty-ee10-servlet
    implementation 'org.eclipse.jetty.ee10:jetty-ee10-servlet:12.0.16'

    implementation 'jakarta.servlet:jakarta.servlet-api:6.0.0' // Para Jetty 12

    testImplementation platform('org.junit:junit-bom:5.10.0')
    testImplementation 'org.junit.jupiter:junit-jupiter'
}

test {
    useJUnitPlatform()
}

application {
    mainClass = 'br.com.spedison.Main'
}
run {
    args = ["0.0.0.0", "8080"]
}

tasks.clean.doLast {
    def logDir = file("./logs")
    if (logDir.exists()) {
        logDir.deleteDir()
        println "[X] - Diretório de logs apagado: ${logDir}"
    } else {
        println "[ ] - Diretório de logs não encontrado, nada para apagar."
    }
}